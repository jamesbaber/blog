<html>
  <head>
    <title>MP3 vs FLAC</title>

    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <link href="../style.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/png" sizes="192x192"  href="../favicon.png">

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>

    <style>
        .answer {
            margin-bottom: 10px;
        }

        .choose {
            position: relative;
            left: 20px;
            width: 40px;
            height: 30px;
            top: -22px;
        }

        audio {
            width: 75%;
        }
    </style>

  </head>
  <body>
    <div class="contentContainer">
        <h1><a href="../">blog.jamesbaber.co.uk</a></h1>
        <h2>Magic ears quiz.</h2>
        Can you work out which file is the highest quality?

        <br />
        <br />

        In no particular order, the following includes 32, 64, 128, 256 and 320 kbps MP3s plus the original 17.8 MB FLAC file.
        Give them all a listen and feel free to skip around. When you think you've found the FLAC, click the check mark and all will be revealed!.

        <br />
        <br />

        Don't forget to wear your best headphones.

        <p>
            Enigma Variations Op.36 IX. (Nimrod) - Adagio

            <br />

            <div id="loading" style="visibility: visible;">
                Loading audio...
            </div>

            <div id="result" style="visibility: visible;"></div>

            <div id="answers" style="visibility: hidden;">
                <div class="answer">
                    <audio id="a" controls preload loop>
                        <source src="samples/32.mp3" type="audio/mpeg">
                    </audio>
                    <button class="choose">✓</button>
                </div>
                <div class="answer">
                    <audio id="b" controls preload loop>
                        <source src="samples/64.mp3" type="audio/mpeg">
                    </audio>
                    <button class="choose">✓</button>
                </div>
                <div class="answer">
                    <audio id="c" controls preload loop>
                        <source src="samples/128.mp3" type="audio/mpeg">
                    </audio>
                    <button class="choose">✓</button>
                </div>
                <div class="answer">
                    <audio id="d" controls preload loop>
                        <source src="samples/256.mp3" type="audio/mpeg">
                    </audio>
                    <button class="choose">✓</button>
                </div>
                <div class="answer">
                    <audio id="e" controls preload loop>
                        <source src="samples/320.mp3" type="audio/mpeg">
                    </audio>
                    <button class="choose">✓</button>
                </div>
                <div class="answer">
                    <audio id="f" controls preload loop>
                        <source src="samples/lossless.flac" type="audio/flac">
                    </audio>
                    <button class="choose">✓</button>
                </div>
            </div>
        </p>

        <script>
            function shuffle() { // https://stackoverflow.com/questions/43979555/javascript-shuffle-divs-within-div/43980082
                var container = document.getElementById("answers");
                var elementsArray = Array.prototype.slice.call(container.getElementsByClassName('answer'));
                elementsArray.forEach(function(element){
                container.removeChild(element);
                })
                shuffleArray(elementsArray);
                elementsArray.forEach(function(element){
                container.appendChild(element);
                })
            }

            function shuffleArray(array) {
                for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
                }
                return array;
            }

            

            players = [
                document.getElementById("a"),
                document.getElementById("b"),
                document.getElementById("c"),
                document.getElementById("d"),
                document.getElementById("e"),
                document.getElementById("f"),
            ];
            
            currentlyPlaying = 0;

            canPlay = 0;

            players.forEach(function(thisPlayer) {
                thisPlayer.addEventListener("play", function() {
                    players.forEach(function(otherPlayer) {
                        if (otherPlayer != thisPlayer) {
                            if (!otherPlayer.paused) {
                                thisPlayer.currentTime = otherPlayer.currentTime;
                                setTimeout(function() {
                                    otherPlayer.pause();
                                }, 1)
                            }
                        }
                    });
                });

                thisPlayer.oncanplaythrough = function() {
                    canPlay += 1;
                    if (canPlay == 6) {
                        document.getElementById("answers").style.visibility = "visible";
                        document.getElementById("loading").style.visibility = "hidden";
                    }
                }
            });

            document.querySelectorAll(".choose").forEach(function(element) {
                element.addEventListener("click", function() {
                    choice = $(element).prevAll('audio').attr("id")

                    document.getElementById("answers").style.visibility = "hidden";
                    document.getElementById("result").style.visibility = "visible";

                    switch (choice) {
                        case "a":
                            result = "How do you keep an idiot in suspense? You picked the 32 kbps MP3 file. It only took 5% of the data from the FLAC file to fool you."
                            break;
                        case "b":
                            result = "Never trust atoms - they make up everything. You picked the 64 kbps file. It only took 10% of the data from the FLAC file to fool you."
                            break;
                        case "c":
                            result = "Not great. You picked the 128 kbps file. It only took 21% of the data from the FLAC file to fool you. Cancel TIDAL and stick to YouTube and Spotify Free from now on."
                            break;
                        case "d":
                            result = "Not a bad show! You picked the 256 kbps file. It only took 42% of the data from the FLAC file to convince you."
                            break;
                        case "e":
                            result = "So close! You picked the top quality MP3 file, 320 kbps. It only took 65% of the data from the FLAC file to convince you. Nothing embarrassing about that - MP3 is popular for a very good reason."
                            break;
                        case "f":
                            result = "Bingo! You really can tell your FLACs from your MP3s. Maybe it's time for a change of career?"
                            break;
                    }

                    document.getElementById("result").innerHTML = result + "<br /><br /><a onclick='window.location.reload();'>Refresh</a> the page to play again.";
                });
            });

            $(function() {
                shuffle();
            });

        </script>

        <div id="disqus_thread"></div>
        <script>
            (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://blog-c6wyj5cl3w.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
        </script>

        <p align="right">
            <a href="https://jamesbaber.co.uk">&copy; James Baber 2020.</a>
        </p>
    </div>
  </body>
</html>
